{% extends "navbar_base.html" %} 

{% block content %}
    <div class="relative top-30 right-20 shadow-none">
        <main class="ml-64 p-8 text-center">
            <h2 class="text-3xl md:text-4xl font-extrabold">
                Available courses: 
            </h2><br>
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <ul>
                        {% for category, message in messages %}
                            <li class="{{ category }}">{{ message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endwith %}
        
            <!-- This form is used to filter the available courses -->
            <form method="GET" action="{{ url_for('view_courses') }}">
                <label for="semester">Semester:</label>
                <select name="semester" id="semester">
                    <option value="">All</option>
                    {% for sem in semesters %}
                        <option value="{{ sem }}" {% if request.args.get('semester') == sem %}selected{% endif %}>{{ sem }}</option>
                    {% endfor %}
                </select>
            
                <label for="location">Location:</label>
                <select name="location" id="location">
                    <option value="">All</option>
                    {% for loc in locations %}
                        <option value="{{ loc }}" {% if request.args.get('location') == loc %}selected{% endif %}>{{ loc }}</option>
                    {% endfor %}
                </select>
            
                <label for="catalog">Catalog:</label>
                <select name="catalog" id="catalog">
                    <option value="">All</option>
                    {% for cat in catalogs %}
                        <option value="{{ cat }}" {% if request.args.get('catalog') == cat %}selected{% endif %}>{{ cat }}</option>
                    {% endfor %}
                </select>
            
                <label for="professor">Professor:</label>
                <select name="professor" id="professor">
                    <option value="">All</option>
                    {% for prof in professors %}
                        <option value="{{ prof }}" {% if request.args.get('professor') == prof %}selected{% endif %}>{{ prof }}</option>
                    {% endfor %}
                </select>
            
                <button type="submit"class="text-white hover:text-black bg-black hover:bg-white 
                font-medium text-sm px-6 py-2 border-2 border-black shadow rounded transition duration-200">Filter</button>
            </form>
        <br>

        <!-- This table displays the filtered courses -->
        <div class="relative shadow-md sm:rounded-lg" style="width: 90%; margin: 0 auto; overflow-x: hidden;">
        <table class="px-4 py-3 w-full text-sm text-left rtl:text-right text-black-500 dark:text-gray-400 border border-gray-400">
            <thead class="text-xs text-gray-700 uppercase dark:text-gray-400 border border-gray-400">
                    <tr>
                        <th scope="col" class="px-4 py-2 border border-gray-400">Course ID</th>
                        <th scope="col" class="px-2 py-2 border border-gray-400">Catalog</th>
                        <th scope="col" class="px-2 py-2 border border-gray-400">Course Number</th>
                        <th scope="col" class="px-10 py-2 border border-gray-400">Course Name</th>
                        <th scope="col" class="px-4 py-2 border border-gray-400">Max Seats</th>
                        <th scope="col" class="px-2 py-2 border border-gray-400">Credits</th>
                        <th scope="col" class="px-10 py-2 border border-gray-400">Semesters Offered</th>
                        <th scope="col" class="px-4 py-2 border border-gray-400">Professors</th>
                        <th scope="col" class="px-12 py-2 border border-gray-400">Locations</th>
                    </tr>
                </thead>
                <tbody>
                    {% for course in courses %}
                    <tr class="bg-white border-b  hover:bg-gray-50">
                        <th scope="row" class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap dark:text-white border border-gray-400">
                            <a href="{{ url_for('course_details', course_id=course.course_id) }}">{{ course.course_id }}</a>
                        </th>
                        <td class="px-2 py-3 border border-gray-400">{{ course.catalog }}</td>
                        <td class="px-2 py-3 border border-gray-400">{{ course.course_number }}</td>
                        <td class="px-10 py-3 border border-gray-400">{{ course.course_name }}</td>
                        <td class="px-4 py-3 border border-gray-400">{{ course.max_seats }}</td>
                        <td class="px-2 py-3 border border-gray-400">{{ course.credits_awarded }}</td>
                        <td class="px-10 py-3 border border-gray-400">{{ course.semesters_offered | join(', ') }}</td> 
                        <td class="px-4 py-3 border border-gray-400">{{ course.faculty | join(', ') }}</td> 
                        <td class="px-12 py-3 border border-gray-400">{{ course.locations_offered | join(', ') }}</td>                 
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <br>

            
        </div>
        </main> 
    </div>
{% endblock %}